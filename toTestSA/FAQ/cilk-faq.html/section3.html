<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head><title>
Cilk FAQ - Section 3
</title>
<link rev="made" href="mailto:bradley@mit.edu">
<link rel="Contents" href="index.html">
<link rel="Start" href="index.html">
<link rel="Previous" href="section2.html"><link rel="Bookmark" title="Cilk FAQ" href="index.html">
</head><body text="#000000" bgcolor="#FFFFFF"><h1>
Cilk FAQ - Section 3 <br>
Using Cilk
</h1>

<ul>
<li><a href="#compile" rel=subdocument>Q3.1. How do I compile a Cilk program?</a>
<li><a href="#slow" rel=subdocument>Q3.2. Cilk seems really slow.</a>
<li><a href="#otherlanguages" rel=subdocument>Q3.3. Can I call Cilk from C/C++/FORTRAN?</a>
<li><a href="#wrongflags" rel=subdocument>Q3.4. The linker says <code>Cilk_flags_are_wrong_*_please_recompile</code>.</a>
</ul><hr>

<h2><A name="compile">
Question 3.1.  How do I compile a Cilk program?
</A></h2>

Use the <code>cilkc</code> command in the same way you would use <code>gcc</code>.  For example, <code>cilkc -O2 program.cilk -o program -lm</code>.  
<p>
<code>cilkc</code> should accept all <code>gcc</code> options, and in addition it accepts the following three options. 

<ul>
<li><code>-cilk-debug</code>: Enable consistency checks in the Cilk runtime
system.  
<li><code>-cilk-profile</code>: Enable collection of profile information
within the Cilk runtime system.  You can print this information by
invoking a Cilk program with the <code>--stats} flag.  
<li><code>-cilk-critical-path</code>: Enable fine-grain collection of the program critical path.  See the Cilk manual for a definition
of the critical path and an explanation of why you may want
to know it.  
</ul>
All files that comprise an executable must be compiled and linked with
the same set of <code>-cilk-*</code> flags.  If not, the linker prints an error message and fails.  
<p>
Additional <code>cilkc</code> arguments are documented in the programming manual.  
<h2><A name="slow">
Question 3.2.  Cilk seems really slow.
</A></h2>

Normally, a <code>spawn</code> is 2--6 times slower than a function call, but Cilk becomes much slower when the critical-path measurements
are enabled.  This problem occurs because Cilk reads the system clock
at every thread boundary (i.e. at every <code>spawn</code>, <code>sync</code>, <code>return</code>).  Some systems, such as Solaris, have fast user-level clock routines, but other systems, such as Linux,
require a system call.  If Cilk programs are still unacceptably slow
(when compared to the C version), please contact
<A href="mailto:cilk-support@lists.sourceforge.net"><code>cilk-support@lists.sourceforge.net</code></A>.  
<h2><A name="otherlanguages">
Question 3.3.  Can I call Cilk from C/C++/FORTRAN?
</A></h2>

Not with Cilk-5.3.  We have an experimental ``library version'' of
Cilk-5.2 which can be called by C, but it was not incorporated into
Cilk-5.3.  
<h2><A name="wrongflags">
Question 3.4.  The linker says <code>Cilk_flags_are_wrong_*_please_recompile</code>.
</A></h2>

All Cilk files that comprise your program must be compiled and linked
with the same Cilk flags.  (See <A href="#compile">Q3.1 `How do I compile a Cilk program?'</A> for a description of the Cilk flags.)  If the flags differ, the linker issues and error message
like the following: <pre>
undefined reference to `Cilk_flags_are_wrong_NODEBUG_NOTIMING_NOSTATS_please_recompile'
</pre>
<hr>
Back: <a href="section2.html" rev=precedes>Installing Cilk</a>.<br>
<a href="index.html" rev=subdocument>Return to contents</a>.<p>
<address>
Bradley C. Kuszmaul / <A href="mailto:bradley@mit.edu">bradley@mit.edu</A>
- 18 June 2014
</address><br>
Extracted from Cilk Frequently Asked Questions with Answers,
Copyright &copy; 2014 Bradley C. Kuszmaul.
</body></html>
